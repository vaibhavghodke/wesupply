<nav class="navbar navbar-light bg-light">
  <div class="container-fluid">
    <div style="display:flex;align-items:center;gap:12px">
      <a [routerLink]="['/']" style="display:inline-block;vertical-align:middle" aria-label="WeSupply Home">
        <img src="assets/logo.png" alt="WeSupply" style="width:56px;height:56px;object-fit:contain;border-radius:8px">
      </a>
      <a class="navbar-brand" [routerLink]="['/']" aria-label="WeSupply">WeSupply</a>
    </div>
    
    <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
      <ng-container *ngIf="currentUser?.role === 'admin'">
        <a [routerLink]="['/manage-items']" aria-label="Manage Items">Manage Items</a>
        <a [routerLink]="['/manage-users']" aria-label="Manage Users">Manage Users</a>
      </ng-container>
      <a [routerLink]="['/register']" aria-label="Register">Register</a>
      <a [routerLink]="['/order-summary']" aria-label="Order Summary">Order Summary</a>

      <div style="margin-left:8px">
        <ng-container *ngIf="currentUser; else notLogged">
          <div style="position:relative;display:inline-block" #userMenuContainer>
            <button 
              id="user-menu-button"
              class="user-icon" 
              (click)="showUserMenu = !showUserMenu" 
              [attr.aria-expanded]="showUserMenu"
              [attr.aria-label]="'Account menu for ' + currentUser.firstname"
              [attr.aria-haspopup]="true"
              type="button"
              title="Account">
              {{ currentUser.firstname ? (currentUser.firstname.charAt(0) + (currentUser.lastname ? currentUser.lastname.charAt(0) : '')) : (currentUser.userid && currentUser.userid.charAt(0)) }}
            </button>
            <div 
              *ngIf="showUserMenu" 
              class="user-menu-dropdown"
              role="menu"
              [attr.aria-labelledby]="'user-menu-button'">
              <div class="user-menu-header">
                <div class="user-menu-name"><strong>{{ currentUser.firstname }} {{ currentUser.lastname }}</strong></div>
                <div class="user-menu-email">{{ currentUser.email }}</div>
              </div>
              <hr class="user-menu-divider" />
              <button 
                class="user-menu-item" 
                (click)="logout()" 
                role="menuitem"
                type="button">
                Logout
              </button>
            </div>
          </div>
        </ng-container>
        <ng-template #notLogged>
          <a [routerLink]="['/login']" aria-label="Login">Login</a>
        </ng-template>
      </div>
    </div>
  </div>
</nav>

<main id="main-content">
  <router-outlet></router-outlet>
</main>
